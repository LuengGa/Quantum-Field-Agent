# Quantum Field Agent V1.5 éƒ¨ç½²æŒ‡å—

## ğŸ“‹ å‰ç½®è¦æ±‚

- Docker & Docker Compose
- OpenAI API Key (æˆ–å…¶ä»–LLMæä¾›å•†)
- è‡³å°‘ 4GB å†…å­˜

## ğŸš€ å¿«é€Ÿéƒ¨ç½²

### 1. é…ç½®ç¯å¢ƒå˜é‡

```bash
cd v1.5/backend
cp .env.example .env
# ç¼–è¾‘ .env æ–‡ä»¶ï¼Œå¡«å…¥ä½ çš„APIå¯†é’¥
```

### 2. å¯åŠ¨æœåŠ¡

```bash
cd v1.5

# æ–¹å¼ä¸€ï¼šåŸºç¡€éƒ¨ç½²ï¼ˆ1ä¸ªAPIèŠ‚ç‚¹ + Redisï¼‰
docker-compose up -d

# æ–¹å¼äºŒï¼šé«˜å¯ç”¨éƒ¨ç½²ï¼ˆ2ä¸ªAPIèŠ‚ç‚¹ + è´Ÿè½½å‡è¡¡ï¼‰
docker-compose up -d --scale api-node-1=1 --scale api-node-2=1

# æ–¹å¼ä¸‰ï¼šå®Œæ•´éƒ¨ç½²ï¼ˆåŒ…å«GPU Workerï¼‰
docker-compose --profile gpu up -d
```

### 3. éªŒè¯éƒ¨ç½²

```bash
# æ£€æŸ¥å¥åº·çŠ¶æ€
curl http://localhost:8000/health

# æŸ¥çœ‹åœºçŠ¶æ€
curl http://localhost:8000/field/status/user_test

# å‘é€æµ‹è¯•æ¶ˆæ¯
curl -X POST http://localhost:8000/chat \
  -H "Content-Type: application/json" \
  -d '{"message": "Hello", "user_id": "test"}'
```

## ğŸ“Š è®¿é—®ç•Œé¢

- **å‰ç«¯ç•Œé¢**: http://localhost:8000/frontend
- **APIæ–‡æ¡£**: http://localhost:8000/docs
- **APIç«¯ç‚¹**: http://localhost:8000/chat

## ğŸ”§ æ¶æ„è¯´æ˜

### æ ¸å¿ƒç»„ä»¶

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   Nginx (LB)    â”‚  â† è´Ÿè½½å‡è¡¡
â”‚   Port: 8000    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
    â”Œâ”€â”€â”€â”€â”´â”€â”€â”€â”€â”
    â”‚         â”‚
â”Œâ”€â”€â”€â–¼â”€â”€â”€â” â”Œâ”€â”€â”€â–¼â”€â”€â”€â”
â”‚API-1  â”‚ â”‚API-2  â”‚  â† 2ä¸ªAPIèŠ‚ç‚¹
â”‚:8001  â”‚ â”‚:8002  â”‚
â””â”€â”€â”€â”¬â”€â”€â”€â”˜ â””â”€â”€â”€â”¬â”€â”€â”€â”˜
    â”‚         â”‚
    â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜
         â”‚
    â”Œâ”€â”€â”€â”€â–¼â”€â”€â”€â”€â”
â”‚Redis      â”‚  â† çŠ¶æ€å­˜å‚¨
â”‚Port: 6379 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### å·¥ä½œæµç¨‹

1. **ä½ç†µ (< 0.8)**: æœ¬åœ°LLMå¿«é€Ÿå¤„ç†
2. **é«˜ç†µ (> 0.8)**: åˆ†å‘åˆ°WorkerèŠ‚ç‚¹å¤„ç†
3. **åœºçŠ¶æ€**: è‡ªåŠ¨åºåˆ—åŒ–åˆ°Redisï¼Œ5åˆ†é’Ÿæœ¬åœ°ç¼“å­˜

## ğŸ› ï¸ å¸¸ç”¨å‘½ä»¤

```bash
# æŸ¥çœ‹æ—¥å¿—
docker-compose logs -f api-node-1

# é‡å¯æœåŠ¡
docker-compose restart

# åœæ­¢æœåŠ¡
docker-compose down

# å®Œå…¨é‡ç½®ï¼ˆåŒ…æ‹¬æ•°æ®ï¼‰
docker-compose down -v

# æŸ¥çœ‹Redisæ•°æ®
docker-compose exec redis-master redis-cli
> KEYS qf:field:*
> GET qf:field:user_test
```

## ğŸ“ˆ ç›‘æ§æŒ‡æ ‡

è®¿é—® http://localhost:8000/stats æŸ¥çœ‹:
- æ´»è·ƒåœºæ•°é‡
- Rediså†…å­˜ä½¿ç”¨
- æœ¬åœ°ç¼“å­˜å¤§å°
- è¿æ¥å®¢æˆ·ç«¯æ•°

## ğŸ”’ ç”Ÿäº§ç¯å¢ƒå»ºè®®

1. **å¯ç”¨HTTPS**: é…ç½®Nginx SSLè¯ä¹¦
2. **é™åˆ¶è®¿é—®**: é…ç½®é˜²ç«å¢™è§„åˆ™
3. **ç›‘æ§å‘Šè­¦**: é›†æˆPrometheus + Grafana
4. **å¤‡ä»½ç­–ç•¥**: å®šæœŸå¤‡ä»½Redisæ•°æ®
5. **æ‰©å±•Worker**: æ ¹æ®è´Ÿè½½æ·»åŠ GPUèŠ‚ç‚¹

## ğŸ†˜ æ•…éšœæ’é™¤

**é—®é¢˜**: Redisè¿æ¥å¤±è´¥
**è§£å†³**: æ£€æŸ¥Redisæ˜¯å¦å¯åŠ¨ `docker-compose ps`

**é—®é¢˜**: APIè¿”å›500é”™è¯¯
**è§£å†³**: æ£€æŸ¥APIå¯†é’¥æ˜¯å¦æ­£ç¡®é…ç½®

**é—®é¢˜**: Workerä¸å¤„ç†ä»»åŠ¡
**è§£å†³**: æ£€æŸ¥Workeræ—¥å¿— `docker-compose logs worker`

## ğŸ“ æ”¯æŒ

å¦‚æœ‰é—®é¢˜ï¼Œè¯·æŸ¥çœ‹æ—¥å¿—æˆ–æäº¤Issueã€‚
