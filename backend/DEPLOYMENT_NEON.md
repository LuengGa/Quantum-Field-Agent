# Quantum Field Agent - Neon + æœåŠ¡å™¨éƒ¨ç½²æŒ‡å—
# ===========================================

## ç›®å½•

1. [æ–¹æ¡ˆæ¶æ„](#æ–¹æ¡ˆæ¶æ„)
2. [Neonæ•°æ®åº“é…ç½®](#neonæ•°æ®åº“é…ç½®)
3. [æœåŠ¡å™¨é…ç½®](#æœåŠ¡å™¨é…ç½®)
4. [æœ¬åœ°å¼€å‘é…ç½®](#æœ¬åœ°å¼€å‘é…ç½®)
5. [éƒ¨ç½²æ­¥éª¤](#éƒ¨ç½²æ­¥éª¤)
6. [è¿ç»´å‘½ä»¤](#è¿ç»´å‘½ä»¤)

---

## ğŸ—ï¸ æ–¹æ¡ˆæ¶æ„

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                         æ¶æ„å›¾                                   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                 â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”‚
â”‚  â”‚    ç”¨æˆ·æµè§ˆå™¨       â”‚         â”‚   CloudBase        â”‚      â”‚
â”‚  â”‚   (Vue3å‰ç«¯)       â”‚         â”‚   (å‰ç«¯æ‰˜ç®¡+CDN)   â”‚      â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â”‚
â”‚            â”‚                                                   â”‚
â”‚            â–¼                                                   â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                        â”‚
â”‚  â”‚  è…¾è®¯äº‘è½»é‡æœåŠ¡å™¨   â”‚                                        â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”‚
â”‚  â”‚  â”‚ Nginx       â”‚ â”‚         â”‚   Neon             â”‚      â”‚
â”‚  â”‚  â”‚ (SSL/ä»£ç†)  â”‚ â”‚â”€â”€â”€â”€â”€â”€â”€â”€â–¶â”‚   PostgreSQL       â”‚      â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚         â”‚   (Serverless)     â”‚      â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚         â”‚   å…è´¹10GB        â”‚      â”‚
â”‚  â”‚  â”‚ FastAPI     â”‚ â”‚         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â”‚
â”‚  â”‚  â”‚ (APIæœåŠ¡)    â”‚ â”‚                                        â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚                                        â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚                                        â”‚
â”‚  â”‚  â”‚ Redis       â”‚ â”‚                                        â”‚
â”‚  â”‚  â”‚ (ç¼“å­˜)      â”‚ â”‚                                        â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚                                        â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                        â”‚
â”‚                                                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

è´¹ç”¨:
- è½»é‡æœåŠ¡å™¨: Â¥30/æœˆ (2æ ¸4G)
- Neon: å…è´¹(10GB) / $25/æœˆ(æ— é™)
- CloudBase: å…è´¹ (é™æ€æ‰˜ç®¡)
- åŸŸå: Â¥5/æœˆ (å¯é€‰)
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
æ€»è®¡: Â¥35-60/æœˆ
```

---

## ğŸ—„ï¸ Neon æ•°æ®åº“é…ç½®

### 1. æ³¨å†Œ Neon

```
1. æ‰“å¼€ https://neon.tech
2. ç‚¹å‡» "Sign Up" æ³¨å†Œ (å¯ç”¨GitHubç™»å½•)
3. å®Œæˆé‚®ç®±éªŒè¯
```

### 2. åˆ›å»ºæ•°æ®åº“

```
1. ç‚¹å‡» "Create Project"
2. é…ç½®:
   - Name: quantum-field-agent
   - PostgreSQL Version: 15
   - Region: us-east-1 (ç¾å›½) æˆ– eu-west-1 (æ¬§æ´²)
   - Compute Size: Autoscale (0-2 vCPU)
3. ç‚¹å‡» "Create Project"
```

### 3. è·å–è¿æ¥å­—ç¬¦ä¸²

```
é¡¹ç›®åˆ›å»ºå®Œæˆåï¼Œä½ ä¼šçœ‹åˆ°:

Connection string:
postgresql://alex:AbC123@ep-xyz.us-east-1.aws.neon.tech/quantum-field-agent?sslmode=require

æˆ–è€…åœ¨ Settings â†’ Connection ä¸­æŸ¥çœ‹
```

### 4. Neon ç‰¹ç‚¹

```
âœ… å…è´¹é¢åº¦:
   - 10GB å­˜å‚¨
   - æ¯æœˆ 300 IOPS
   - 3ä¸ªæ•°æ®åº“åˆ†æ”¯ (dev/test/prod)

âœ… é«˜çº§åŠŸèƒ½ (ä»˜è´¹):
   - æ— é™å­˜å‚¨
   - æ›´é«˜IOPS
   - ä¼˜å…ˆæ”¯æŒ
```

---

## ğŸ–¥ï¸ æœåŠ¡å™¨é…ç½®

### 1. è´­ä¹°è½»é‡æœåŠ¡å™¨

```
è…¾è®¯äº‘: https://cloud.tencent.com/product/lighthouse

æ¨èé…ç½®:
- åœ°åŸŸ: ä¸Šæµ· (ä½å»¶è¿Ÿ)
- CPU: 2æ ¸
- å†…å­˜: 4GB
- ç£ç›˜: 50GB SSD
- ç³»ç»Ÿ: Ubuntu 22.04 LTS
- å¸¦å®½: 5Mbps
- è´¹ç”¨: Â¥30/æœˆ
```

### 2. è¿æ¥æœåŠ¡å™¨

```bash
# SSH è¿æ¥
ssh root@ä½ çš„æœåŠ¡å™¨IP

# å¯†ç åœ¨è…¾è®¯äº‘æ§åˆ¶å°è·å–
```

### 3. å®‰è£…ç¯å¢ƒ

```bash
# æ›´æ–°ç³»ç»Ÿ
apt update && apt upgrade -y

# å®‰è£… Docker
curl -fsSL https://get.docker.com | sh
usermod -aG docker $USER

# å®‰è£… Docker Compose
pip install docker-compose
```

---

## ğŸ’» æœ¬åœ°å¼€å‘é…ç½®

### 1. ç¯å¢ƒå˜é‡

```bash
# .env æ–‡ä»¶ (æœ¬åœ°å¼€å‘)
cd backend

cat > .env << EOF
# Neon æ•°æ®åº“ (ç”Ÿäº§)
DATABASE_TYPE=postgresql
DATABASE_URL=postgresql://user:pass@ep-xxx.us-east-1.aws.neon.tech/quantum-field-agent?sslmode=require

# æˆ–è€…æœ¬åœ° SQLite (å¼€å‘)
DATABASE_TYPE=sqlite
DATABASE_URL=sqlite:///data/evolution.db

# Redis (å¯é€‰)
REDIS_HOST=localhost
REDIS_PORT=6379

# å®‰å…¨
SECRET_KEY=your-secret-key-here
EOF
```

### 2. ä¿®æ”¹ä»£ç æ”¯æŒ Neon

```python
# evolution/database.py ä¸­ä¿®æ”¹è¿æ¥é€»è¾‘

def get_connection_string():
    import os
    db_type = os.getenv("DATABASE_TYPE", "sqlite")
    
    if db_type == "postgresql":
        return os.getenv("DATABASE_URL")
    else:
        return "sqlite:///data/evolution.db"
```

### 3. æœ¬åœ°æµ‹è¯• Neon

```bash
# 1. å®‰è£… PostgreSQL é©±åŠ¨
pip install psycopg2-binary

# 2. æµ‹è¯•è¿æ¥
python3 -c "
import os
from evolution.database import EvolutionDatabase

db = EvolutionDatabase()
print('âœ… æ•°æ®åº“è¿æ¥æˆåŠŸ')
"
```

---

## ğŸš€ éƒ¨ç½²æ­¥éª¤

### æ–¹å¼ä¸€ï¼šä¸€é”®éƒ¨ç½²

```bash
# 1. ä¸Šä¼ é¡¹ç›®åˆ°æœåŠ¡å™¨
scp -r quantum-field-agent root@ä½ çš„IP:/opt/

# 2. SSH è¿æ¥æœåŠ¡å™¨
ssh root@ä½ çš„IP

# 3. æ‰§è¡Œéƒ¨ç½²
cd /opt/quantum-field-agent/backend
chmod +x deploy_neon.sh
./deploy_neon.sh full
```

### æ–¹å¼äºŒï¼šæ‰‹åŠ¨éƒ¨ç½²

```bash
# 1. å®‰è£…ä¾èµ–
apt update
apt install -y python3-pip docker.io

# 2. é…ç½®ç¯å¢ƒå˜é‡
cat > /opt/quantum-field-agent/backend/.env << EOF
DATABASE_TYPE=postgresql
DATABASE_URL=postgresql://user:pass@ep-xxx.us-east-1.aws.neon.tech/quantum-field-agent?sslmode=require
SECRET_KEY=your-production-secret-key
LOG_LEVEL=INFO
EOF

# 3. å®‰è£… Python ä¾èµ–
cd /opt/quantum-field-agent/backend
pip install -r requirements.txt
pip install psycopg2-binary uvicorn

# 4. å¯åŠ¨æœåŠ¡
nohup python3 -m uvicorn main:app --host 0.0.0.0 --port 8000 > logs/app.log 2>&1 &

# 5. é…ç½® Nginx (è§ä¸‹æ–¹)
```

### 3. é…ç½® Nginx

```bash
# å®‰è£… Nginx
apt install -y nginx

# é…ç½®
cat > /etc/nginx/sites-available/quantum-field << EOF
server {
    listen 80;
    server_name your-domain.com;

    location / {
        proxy_pass http://127.0.0.1:8000;
        proxy_set_header Host \$host;
        proxy_set_header X-Real-IP \$remote_addr;
    }
}
EOF

ln -s /etc/nginx/sites-available/quantum-field /etc/nginx/sites-enabled/
nginx -t
systemctl restart nginx
```

### 4. é…ç½®åŸŸå (å¯é€‰)

```
è…¾è®¯äº‘ â†’ åŸŸåæ³¨å†Œ â†’ è´­ä¹°åŸŸå
DNSè§£æ â†’ æ·»åŠ è®°å½•:
  - Aè®°å½• @ æœåŠ¡å™¨IP
  - CNAME www æœåŠ¡å™¨IP
```

---

## ğŸ”§ è¿ç»´å‘½ä»¤

### æœåŠ¡ç®¡ç†

```bash
# æŸ¥çœ‹çŠ¶æ€
./deploy_neon.sh status

# æŸ¥çœ‹æ—¥å¿—
tail -f /opt/quantum-field-agent/backend/logs/app.log

# é‡å¯æœåŠ¡
./deploy_neon.sh restart

# åœæ­¢æœåŠ¡
./deploy_neon.sh stop

# æ›´æ–°éƒ¨ç½²
./deploy_neon.sh update
```

### æ•°æ®åº“å¤‡ä»½

```bash
# Neon è‡ªåŠ¨å¤‡ä»½ï¼Œæ— éœ€æ‰‹åŠ¨æ“ä½œ
# å¦‚éœ€æ‰‹åŠ¨å¤‡ä»½:
pg_dump "postgresql://user:pass@ep-xxx.us-east-1.aws.neon.tech/quantum-field-agent" > backup.sql
```

### ç›‘æ§

```bash
# API å¥åº·æ£€æŸ¥
curl http://localhost:8000/health

# æŸ¥çœ‹è¿›ç¨‹
ps aux | grep uvicorn

# æŸ¥çœ‹ç«¯å£
netstat -tlnp | grep 8000
```

---

## ğŸ”’ å®‰å…¨é…ç½®

### 1. é˜²ç«å¢™

```bash
# è…¾è®¯äº‘æ§åˆ¶å° â†’ é˜²ç«å¢™
å¼€æ”¾ç«¯å£:
- 22 (SSH)
- 80 (HTTP)
- 443 (HTTPS)
```

### 2. SSL è¯ä¹¦

```bash
# å®‰è£… Certbot
apt install -y certbot python3-certbot-nginx

# ç”³è¯·è¯ä¹¦
certbot --nginx -d your-domain.com
```

### 3. ç¯å¢ƒå˜é‡å®‰å…¨

```bash
# ä¸è¦æäº¤ .env åˆ° Git
echo ".env" >> .gitignore
```

---

## ğŸ“Š ç›‘æ§å‘Šè­¦

### è…¾è®¯äº‘äº‘ç›‘æ§

```
1. è…¾è®¯äº‘æ§åˆ¶å° â†’ äº‘ç›‘æ§
2. åˆ›å»ºå‘Šè­¦ç­–ç•¥:
   - CPUä½¿ç”¨ç‡ > 80%
   - å†…å­˜ä½¿ç”¨ç‡ > 85%
   - ç£ç›˜ä½¿ç”¨ç‡ > 90%
3. è®¾ç½®é€šçŸ¥: çŸ­ä¿¡/é‚®ä»¶
```

### Neon æ§åˆ¶å°

```
Neon æ§åˆ¶å° â†’ Project â†’ Monitoring
æŸ¥çœ‹:
- CPU ä½¿ç”¨ç‡
- IOPS ä½¿ç”¨ç‡
- å­˜å‚¨ä½¿ç”¨é‡
```

---

## ğŸ’° è´¹ç”¨æ€»ç»“

| é¡¹ç›® | å…è´¹ | ä»˜è´¹ |
|------|------|------|
| Neon | 10GB | $25/æœˆèµ· |
| è½»é‡æœåŠ¡å™¨ | - | Â¥30/æœˆ |
| åŸŸå | - | Â¥5/æœˆ |
| SSLè¯ä¹¦ | å…è´¹ | å…è´¹ |
| **æ€»è®¡** | Â¥35/æœˆ | Â¥60/æœˆèµ· |

---

## â“ å¸¸è§é—®é¢˜

### Q1: Neon è¿æ¥å¤±è´¥ï¼Ÿ

```bash
# æ£€æŸ¥è¿æ¥å­—ç¬¦ä¸²
curl "postgresql://user:pass@ep-xxx.us-east-1.aws.neon.tech/quantum-field-agent?sslmode=require" -o /dev/null -w "%{http_code}"

# ç¡®è®¤ IP ç™½åå•
Neon â†’ Settings â†’ IP Allowlist â†’ Add 0.0.0.0/0
```

### Q2: æ€§èƒ½å·®ï¼Ÿ

```
Neon:
- å‡çº§åˆ°ä»˜è´¹è®¡åˆ’
- å¢åŠ  compute size

æœåŠ¡å™¨:
- å‡çº§é…ç½®
- æ·»åŠ  Redis ç¼“å­˜
```

### Q3: å¦‚ä½•è¿ç§»æ•°æ®åº“ï¼Ÿ

```bash
# ä» SQLite è¿ç§»
python3 -c "
import sqlite3
import psycopg2

# è¯»å– SQLite
conn1 = sqlite3.connect('data/evolution.db')
# å†™å…¥ PostgreSQL
conn2 = psycopg2.connect('postgresql://...')
# è¿ç§»æ•°æ®...
"
```

---

## âœ… å¿«é€Ÿæ£€æŸ¥æ¸…å•

- [ ] Neon è´¦æˆ·åˆ›å»º
- [ ] æ•°æ®åº“è¿æ¥æµ‹è¯•
- [ ] è½»é‡æœåŠ¡å™¨è´­ä¹°
- [ ] Docker å®‰è£…
- [ ] é¡¹ç›®ä¸Šä¼ 
- [ ] ç¯å¢ƒå˜é‡é…ç½®
- [ ] æœåŠ¡å¯åŠ¨æµ‹è¯•
- [ ] åŸŸåè§£æ (å¯é€‰)
- [ ] SSL è¯ä¹¦ (å¯é€‰)
- [ ] ç›‘æ§å‘Šè­¦é…ç½®

---

## ğŸ“ è·å–å¸®åŠ©

- Neon æ–‡æ¡£: https://neon.tech/docs
- è…¾è®¯äº‘æ–‡æ¡£: https://cloud.tencent.com/document
- é¡¹ç›®é—®é¢˜: GitHub Issues
